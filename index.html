<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Game</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>


    <script src="jgestures.min.js"  type="text/javascript"></script>
    <script src="http://code.jquery.com/mobile/1.0a3/jquery.mobile-1.0a3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="controls.css" />
    <link rel="stylesheet" type="text/css" href="menu.css" />
    <script type="text/javascript" src="controls.js"></script>
    <script type="text/javascript" src="additional.js"></script>
    <script type="text/javascript" src="classes.js"></script>
    <script type="text/javascript" src="createObjects.js"></script>
    <script type="text/javascript" src="draw.js"></script>
    <script type="text/javascript" src="enemy_ai.js"></script>
    <meta name="viewport" content="initial-scaling=1; minimum-
scaling=1; maximum-scaling=1; user-scalable=no;" />
    <script>
        function ng(){
            removeElement(document.getElementById("field"));
            createObjects();
            resize();
            window.onresize = function() {
                resize();
            };
            $('#menu').hide();
            $('#over').hide();
            $("#field:hidden").show();
            $('#manag:hidden').show();
        }
        function pause() {
            $('#menu:hidden').show();
            $('#field').hide();
            $('#manag').hide();
        }
        function cont(){
            $('#menu').hide();
            $('#over').hide();
            $("#field:hidden").show();
            $('#manag:hidden').show();
        }

    </script>

    <script type="text/javascript" src="draw.js"></script>



    <style>
        html,body{
            min-height:100%;
            height:100%;
        }

        body{
            padding:0px;
            margin:0px;
            text-align:center;
        }

            /* .partOfBackground{
                width:32px;
                height:32px;
                background-color: #adff2f !important;
                display: inline-block;
            }

            .partOfBackground{
                -webkit-transition: all 0.5s ease;
                -moz-transition: all 0.5s ease;
                -o-transition: all 0.5s ease;
                -ms-transition: all 0.5s ease;
                transition: all 0.5s ease;
            }*/





    </style>



</head>
<body style="background-color: #000">
<center>
<div id="menu">
    <div id="top_pic"></div>
    <div id="name" align="center"></div><br>
    <div id="new game" >
        <a href="index.html" onclick="ng()"><img src="images/ng.png" ></a>
    </div>
    <div id="continue">
        <a href="" onclick="cont()"><img src="images/cont.png"></a>
    </div>
   <!-- <div id="new_game">
        <a href="index.html"><img src="images/ng.png"></a>
    </div>
    <div id="continue">
        <a href="index.html"><img src="images/cont.png"></a>
    </div>-->
</div>
    <div id="over">
        <div id="go"></div>
        <div id="score"></div><br>
        <div id="try">
            <a href="" onclick="ng()"><img src="images/ta.png"></a>
        </div><br><br><br>
        <div id="sad"></div>
    </div>
</center>

<script type="text/javascript">
    var i, j ,k;
    var bombsCounter = 0;
    firesCounter = 0;

    window.scrollTo(0, 1);


    //Main field


    //Bombs


    //Background of the field

    background = new Array();


    //Block of the field
    blocks = new Array();
    //Box
    boxes = new Array();

    //Player
    player = new Player(0, 0);

    player_go = false;
    player_go_x = 0;
    player_go_y = 0;

    //Bombs
    bombs = new Array();

    fires = new Array();

    enemies = new Array();

    //Creating an objects

    //Main loop
    setInterval(function() {
        //clearDOM();
        //update(bombs);

        draw(player, bombs, fires, enemies);
        if (player_go) {
            var to_go = pathFind(player.x, player.y, player_go_x, player_go_y);
            if (to_go[2]) {
                player_go = false;
            } else {
                player.goTo(to_go[0], to_go[1]);
            }
        }
    }, 200);
    setInterval(function() {
        //clearDOM();
        //update(bombs);
        for (var i=0; i<enemies.length; i++) {
            if (!enemies[i].dead) {
                var to_go = pathFind(enemies[i].x, enemies[i].y, player.x, player.y);
                enemies[i].goTo(to_go[0], to_go[1]);
                if ((getRandomInt(0,25)<2) && (enemies[i].just_put > 4)) {
                    putBomb(bombs, enemies[i].getX(),enemies[i].getY(), ++bombsCounter, ++firesCounter)
                    enemies[i].just_put = 0;
                } else {
                    var dist = Math.sqrt(Math.pow(enemies[i].x-player.x,2)+Math.pow(enemies[i].y-player.y,2))
                    if ((dist<3) && (enemies[i].just_put > 4)) {
                        putBomb(bombs, enemies[i].getX(),enemies[i].getY(), ++bombsCounter, ++firesCounter)
                        enemies[i].just_put = 0;
                    }
                }
                enemies[i].just_put += 1;
            }
        }


    }, 1000);


    $(document).ready(function() {
        jQuery('.left').bind('tapone',function(){
            goTo('left', 20, player);
        });

        jQuery('.right').bind('tapone',function(){
            goTo('right', 20, player);
        });

        jQuery('.top').bind('tapone',function(){
            goTo('top', 20, player);
        });

        jQuery('.bottom').bind('tapone',function(){
            goTo('bottom', 20, player);
        });
        jQuery('.bomb_creation').bind('click',function(){
            putBomb(bombs, player.getX(),player.getY(), ++bombsCounter, ++firesCounter)
        });

    })
</script>
<div id="controls">
    <span class="left"></span>
    <span class="top"></span>
    <span class="bottom" ></span>
    <span class="right"></span>
</div>
<div style="position: absolute; top: 400px; left: 800px;">
    <input class="bomb_creation" type="button" value="Bomb">
</div>


</body>

</html>